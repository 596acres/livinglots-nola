{% load blog_widgets i18n inplace_tags static %}

<script id="popup-template" type="text/x-handlebars-template">
    {% verbatim %}
        <div>
            <a href="{{detailUrl}}">
                {{feature.properties.address_line1}}
            </a>
        </div>
    {% endverbatim %}
</script>

<div id="map" style="width: 100%; height: 400px;"
    data-l-zoom="10"
    data-l-center="[29.951066, -90.071532]"

    data-l-apikey="{% inplace_setting PLACES_CLOUDMADE_KEY %}"
    data-l-styleid="{% inplace_setting PLACES_CLOUDMADE_STYLE %}"
    data-l-lotsurl="{% url "lots:geojson" %}"
></div>

<div id="map-left">

    <div id="streetview-container" style="padding: 25px; display: none;">
        <div id="streetview" style="height: 300px; width: 100%;">
        </div>
        <div id="streetview-error" class="streetview">
            {% trans "Sorry, we couldn't find streetview imagery for this lot." %}
        </div>
    </div>

    <div class="map-find-a-lot-container searchbar">
        <div class="map-find-a-lot">
            <form class="map-find-a-lot-form">
                <label for="search">{% trans "Find a lot" %}</label>
                <input id="search" name="search" placeholder="{% trans "Search by address, zip code, or neighborhood" %}" type="text" />
                <button class="map-find-a-lot-submit" type="submit">{% trans "GO" %}</button>
                <div class="warning" style="display: none;"></div>
            </form>
        </div>
    </div>

    <div>
        <a class="map-filters-toggle">
            {% trans "Advanced Search Tools" %}
        </a>
    </div>

    <div class="map-filters grid">

        <div class="filters">
            <form>
                {% for hidden_field in filters.hidden_fields %}
                {{ hidden_field }}
                {% endfor %}
            </form>
        </div>

        <div>
            <h2>Filters</h2>
            {{ filters.form.as_p }}
        </div>

    </div>

    <div class="map-tally-container grid">
        <h2>{% trans "You are currently looking at" %}</h2>
        <div class="map-tally">
            <div class="grid grid-1-4">
                <span class="count lots-count">...</span> {% trans "lots" %}
            </div>
            <div class="grid grid-1-4">
                <span class="count no-known-use-count">...</span> {% trans "lots with no known use" %}
            </div>
            <div class="grid grid-1-4">
                <span class="count in-use-count">...</span> {% trans "lots being used as community spaces" %}
            </div>

            <div class="grid grid-1-4">
                <a href="#" class="export-link">{% trans "Link to this view" %}</a>. 
                {% trans "Or download current lots as" %}
                <a href="#" class="export-csv" data-baseurl="{% url "lots:csv" %}?">{% trans "a spreadsheet" %}</a>,
                <a href="#" class="export-geojson" data-baseurl="{% url "lots:geojson" %}?download=yes&">{% trans "GeoJSON" %}</a>, or
                <a href="#" class="export-kml" data-baseurl="{% url "lots:kml" %}?">{% trans "KML" %}</a>.
            </div>

        </div>
    </div>

    <div class="clear"></div>
</div>

<div id="map-right" class="grid grid-1-4 clearfix">

    <div class="social-media clearfix">
        <ul>
            <li class="social-media-icon">
                <a href="https://twitter.com/Grounded215" class="social-twitter" target="_blank"></a>
            </li>
        </ul>
    </div>

    <div class="map-sidebar-section">
        <h2>{% trans "Recent News" %}</h2>
        <ul class="recent-entries">
            {% get_entries 3 %}
            {% for entry in entries %}
                <li class="recent-entry">
                    <a href="{{ entry.get_absolute_url }}">{{ entry }}</a>
                </li>
            {% endfor %}
        </ul>
    </div>

    <div class="activity-stream-section map-sidebar-section">
        <h2>{% trans "Recent Activities" %}</h2>
        <div class="activity-stream">
            <div class="activity-stream-container"></div>
            <div class="activity-stream-nav" style="display: none;">
                <a href="/activity-stream/">next page</a>
            </div>
        </div>
    </div>

</div>

<div id="map-overlay">
    <a class="map-overlay-close-button">Ã—</a>
    {% blocktrans %}
    {% endblocktrans %}
    <button class="map-overlay-button right-arrow-button" type="button">
        {% trans "Find the lot in your life!" %}
    </button>
</div>
